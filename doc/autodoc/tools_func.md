# Module tools_func

| Type | Name | Purpose | Arguments |     | Type | Intent |
| :--: | :--: | :------ | ----: | :-------- | :--: | :----: |
| function | [fletcher32](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L50) | Fletcher-32 checksum algorithm | **var** |  Variable | real(kind_real) | in |
| subroutine | [lonlatmod](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L70) | set latitude between -pi/2 and pi/2 and longitude between -pi and pi | **lon**<br>**lat** |  Longitude (radians)<br> Latitude (radians) | real(kind_real)<br>real(kind_real) | inout<br>inout |
| function | [lonlathash](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L101) | define a unique real from a lon/lat pair | **lon**<br>**lat**<br>**il** |  Longitude (radians)<br> Latitude (radians)<br> Level | real(kind_real)<br>real(kind_real)<br>integer | in<br>in<br>in |
| subroutine | [sphere_dist](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L133) | compute the great-circle distance between two points | **lon_i**<br>**lat_i**<br>**lon_f**<br>**lat_f**<br>**dist** |  Initial point longitude (radians)<br> Initial point latitude (radians)<br> Final point longitude (radians)<br> Final point longilatitudetude (radians)<br> Great-circle distance | real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real) | in<br>in<br>in<br>in<br>out |
| subroutine | [reduce_arc](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L160) | reduce arc to a given distance | **lon_i**<br>**lat_i**<br>**lon_f**<br>**lat_f**<br>**maxdist**<br>**dist** |  Initial point longitude (radians)<br> Initial point latitude (radians)<br> Final point longitude (radians)<br> Final point latitude (radians)<br> Maximum distance<br> Effective distance | real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real) | in<br>in<br>inout<br>inout<br>in<br>out |
| subroutine | [lonlat2xyz](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L197) | convert longitude/latitude to cartesian coordinates | **mpl**<br>**lon**<br>**lat**<br>**x**<br>**y**<br>**z** |  MPI data<br> Longitude (radians)<br> Latitude (radians)<br> X coordinate<br> Y coordinate<br> Z coordinate | type(mpl_type)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real) | inout<br>in<br>in<br>out<br>out<br>out |
| subroutine | [xyz2lonlat](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L236) | convert longitude/latitude to cartesian coordinates | **mpl**<br>**x**<br>**y**<br>**z**<br>**lon**<br>**lat** |  MPI data<br> X coordinate<br> Y coordinate<br> Z coordinate<br> Longitude (radians)<br> Latitude (radians) | type(mpl_type)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real) | in<br>in<br>in<br>in<br>out<br>out |
| subroutine | [vector_product](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L270) | compute normalized vector product | **v1**<br>**v2**<br>**vp** |  First vector<br> Second vector<br> Vector product | real(kind_real)<br>real(kind_real)<br>real(kind_real) | in<br>in<br>out |
| subroutine | [vector_triple_product](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L299) | compute vector triple product | **v1**<br>**v2**<br>**v3**<br>**p**<br>**cflag** |  First vector<br> Second vector<br> Third vector<br> Triple product<br> Confidence flag | real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>logical | in<br>in<br>in<br>out<br>out |
| subroutine | [add](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L337) | check if value missing and add if not missing | **mpl**<br>**val**<br>**cumul**<br>**num**<br>**wgt** |  MPI data<br> Value to add<br> Cumul<br> Number of values<br> Weight | type(mpl_type)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real) | in<br>in<br>inout<br>inout<br>in |
| subroutine | [divide](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L365) | check if value missing and divide if not missing | **mpl**<br>**val**<br>**num** |  MPI data<br> Value to divide<br> Divider | type(mpl_type)<br>real(kind_real)<br>real(kind_real) | in<br>inout<br>in |
| subroutine | [fit_diag](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L395) | compute diagnostic fit function | **mpl**<br>**nc3**<br>**nl0r**<br>**nl0**<br>**l0rl0_to_l0**<br>**disth**<br>**distv**<br>**coef**<br>**rh**<br>**rv**<br>**fit** |  MPI data<br> Number of classes<br> Effective number of levels<br> Number of levels<br> Effective level to level<br> Horizontal distance<br> Vertical distance<br> Diagonal coefficient<br> Horizontal support radius<br> Vertical support radius<br> Fit | type(mpl_type)<br>integer<br>integer<br>integer<br>integer<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real) | inout<br>in<br>in<br>in<br>in<br>in<br>in<br>in<br>in<br>in<br>out |
| function | [gc99](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L562) | Gaspari and Cohn (1999) function, with the support radius as a parameter | **distnorm** |  Normalized distance | real(kind_real) | in |
| function | [fit_func](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L586) | fit_function | **mpl**<br>**distnorm** |  MPI data<br> Normalized distance | type(mpl_type)<br>real(kind_real) | inout<br>in |
| subroutine | [fit_lct](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L625) | LCT fit | **mpl**<br>**nc**<br>**nl0**<br>**dxsq**<br>**dysq**<br>**dxdy**<br>**dzsq**<br>**dmask**<br>**nscales**<br>**D**<br>**coef**<br>**fit** |  MPI data<br> Number of classes<br> Number of levels<br> Zonal separation squared<br> Meridian separation squared<br> Zonal x meridian separations product<br> Vertical separation squared<br> Mask<br> Number of LCT scales<br> LCT components<br> LCT coefficients<br> Fit | type(mpl_type)<br>integer<br>integer<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>logical<br>integer<br>real(kind_real)<br>real(kind_real)<br>real(kind_real) | inout<br>in<br>in<br>in<br>in<br>in<br>in<br>in<br>in<br>in<br>in<br>out |
| subroutine | [lct_d2h](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L693) | from D (Daley tensor) to H (local correlation tensor) | **mpl**<br>**D11**<br>**D22**<br>**D33**<br>**D12**<br>**H11**<br>**H22**<br>**H33**<br>**H12** |  MPI data<br> Daley tensor component 11<br> Daley tensor component 22<br> Daley tensor component 33<br> Daley tensor component 12<br> Local correlation tensor component 11<br> Local correlation tensor component 22<br> Local correlation tensor component 33<br> Local correlation tensor component 12 | type(mpl_type)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real) | inout<br>in<br>in<br>in<br>in<br>out<br>out<br>out<br>out |
| subroutine | [lct_h2r](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L733) | from H (local correlation tensor) to support radii | **mpl**<br>**H11**<br>**H22**<br>**H33**<br>**H12**<br>**rh**<br>**rv** |  MPI data<br> Local correlation tensor component 11<br> Local correlation tensor component 22<br> Local correlation tensor component 33<br> Local correlation tensor component 12<br> Horizontal support radius<br> Vertical support radius | type(mpl_type)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real) | inout<br>in<br>in<br>in<br>in<br>out<br>out |
| subroutine | [lct_r2d](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L779) | from support radius to Daley tensor diagonal element | **r**<br>**D** |  Support radius<br> Daley tensor diagonal element | real(kind_real)<br>real(kind_real) | in<br>out |
| subroutine | [check_cond](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L798) | check tensor conditioning | **d1**<br>**d2**<br>**nod**<br>**valid** |  First diagonal coefficient<br> Second diagonal coefficient<br> Normalized off-diagonal coefficient<br> Conditioning validity | real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>logical | in<br>in<br>in<br>out |
| function | [matern](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L838) | compute the normalized diffusion function from eq. (55) of Mirouze and Weaver (2013), for the 3d case (d = 3) | **mpl**<br>**M**<br>**x** |  MPI data<br> Matern function order<br> Argument | type(mpl_type)<br>integer<br>real(kind_real) | inout<br>in<br>in |
| subroutine | [cholesky](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L884) | compute cholesky decomposition | **mpl**<br>**n**<br>**a**<br>**u**<br>**ierr** |  MPI data<br> Matrix rank<br> Matrix<br> Matrix square-root<br> Error status | type(mpl_type)<br>integer<br>real(kind_real)<br>real(kind_real)<br>integer | inout<br>in<br>in<br>out<br>out |
| subroutine | [syminv](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L937) | compute inverse of a symmetric matrix | **mpl**<br>**n**<br>**a**<br>**c**<br>**ierr** |  MPI data<br> Matrix rank<br> Matrix<br> Matrix inverse<br> Error status | type(mpl_type)<br>integer<br>real(kind_real)<br>real(kind_real)<br>integer | inout<br>in<br>in<br>out<br>out |
| subroutine | [histogram](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L992) | compute bins and histogram from a list of values | **mpl**<br>**nlist**<br>**list**<br>**nbins**<br>**histmin**<br>**histmax**<br>**bins**<br>**hist** |  MPI data<br> List size<br> List<br> Number of bins<br> Histogram minimum<br> Histogram maximum<br> Bins<br> Histogram | type(mpl_type)<br>integer<br>real(kind_real)<br>integer<br>real(kind_real)<br>real(kind_real)<br>real(kind_real)<br>real(kind_real) | inout<br>in<br>in<br>in<br>in<br>in<br>out<br>out |
