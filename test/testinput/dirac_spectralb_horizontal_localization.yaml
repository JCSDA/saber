geometry:
  function space: StructuredColumns
  grid:
    type: regular_gaussian
    N: 15
  groups:
  - variables:
    - streamfunction
    - velocity_potential
    - unbalanced_pressure
    - moisture_control_variable
    levels: 2
  partitioner: ectrans
background:
  date: '2010-01-01T12:00:00Z'
  state variables:
  - streamfunction
  - velocity_potential
  - unbalanced_pressure
  - moisture_control_variable
background error:
  covariance model: SABER
  adjoint test: true
  inverse test: true
  saber central block:
    saber block name: ID
  saber outer blocks:
  - saber block name: spectral analytical filter
    function:
      horizontal daley length: 5008e3  # For localization to be 0.5 on 1st diagnostic point in theory
    # Line below deactivates outer inverse test by applying the comparison to no variables.
    # TODO(Mayeul): Restore outer inverse test once it can use *relative* tolerance
    inner variables to compare: []
  - saber block name: spectral to gauss
dirac:
  lon:
  - 240.0
  - 18.0
  - 180.0
  - 90.0
  lat:
  - 85.48
  - 61.95
  - 32.45
  - 2.95
  level:
  - 1
  - 1
  - 2
  - 2
  variable:
  - streamfunction
  - velocity_potential
  - unbalanced_pressure
  - moisture_control_variable
diagnostic points:
  lon:
  - 240.0  # Theorical value 0.5
  - 198.0  # Test across pole.
  - 180.0  # Test across levels. Theorical value 0.0
  - 60.0   # Test on level 2.
  lat:
  - 32.45
  - 67.85
  - 32.45
  - 2.95
  level:
  - 1
  - 1
  - 1
  - 2
  variable:
  - streamfunction
  - velocity_potential
  - unbalanced_pressure
  - moisture_control_variable
output dirac:
  mpi pattern: '%MPI%'
  filepath: testdata/dirac_spectralb_horizontal_localization/%MPI%_dirac_%id%

test:
  reference filename: testref/dirac_spectralb_horizontal_localization.ref
  test output filename: testref/dirac_spectralb_horizontal_localization.out
