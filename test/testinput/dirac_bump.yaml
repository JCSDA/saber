geometry:
  function space: StructuredColumns
  grid:
    type: regular_lonlat
    N: 10
  levels: 2
  halo: 1
initial condition:
  date: '2010-01-01T12:00:00Z'
  state variables:
  - var3
  - var4
background error:
  covariance model: hybrid
  components:
  - covariance:
      covariance model: SABER
      saber central block:
        saber block name: BUMP_NICAS
        bump:
          general:
            datadir: testdata
            prefix: dirac_bump/_MPI_-_OMP_
            testing: true
            nprocio: 1
          drivers:
            strategy: specific_univariate
            load_nicas_local: true
          files:
            fname_nicas: error_covariance_training_bump_hdiag-nicas_1/_MPI_-_OMP__nicas
        input fields:
        - parameter: universe radius
          file:
            filepath: testdata/error_covariance_training_bump_hdiag-nicas_1/_MPI_-_OMP__cor_rh_2
      saber outer blocks:
      - saber block name: BUMP_StdDev
        bump:
          general:
            datadir: testdata
            prefix: dirac_bump/_MPI_-_OMP_
            testing: true
        input fields:
        - parameter: stddev
          file:
            filepath: testdata/error_covariance_training_bump_stddev_3/_MPI_-_OMP__stddev
      - saber block name: BUMP_StdDev
        bump:
          general:
            datadir: testdata
            prefix: dirac_bump/_MPI_-_OMP_
            testing: true
          drivers:
            new_var: true
          variance:
            forced_var: true
            stddev:
              var1:
              - 1.0
              var2:
              - 2.0
      - saber block name: StdDev
        input fields:
        - parameter: StdDev
          file:
            filepath: testdata/error_covariance_training_bump_stddev_3/_MPI_-_OMP__stddev
      - saber block name: BUMP_VerticalBalance
        bump:
          general:
            datadir: testdata
            prefix: dirac_bump/_MPI_-_OMP_
            testing: true
          drivers:
            load_samp_local: true
            load_vbal: true
          files:
            fname_samp: error_covariance_training_bump_vbal_1/_MPI_-_OMP__sampling
            fname_vbal: error_covariance_training_bump_vbal_1/_MPI_-_OMP__vbal
          vertical balance:
            vbal:
            - balanced: var2
              unbalanced: var1
      - saber block name: BUMP_PsiChiToUV
        active variables:
        - var1
        - var2
        - var3
        - var4
        bump:
          general:
            datadir: testdata
            prefix: dirac_bump/_MPI_-_OMP_
            testing: true
            nprocio: 1
          drivers:
            load_wind_local: true
          files:
            fname_wind: error_covariance_training_bump_wind/_MPI_-_OMP__wind
          wind:
            wind_streamfunction: var1
            wind_velocity_potential: var2
            wind_zonal: var3
            wind_meridional: var4
    weight:
      value: 0.5
  - covariance:
      covariance model: ensemble
      members from template:
        template:
          date: '2010-01-01T12:00:00Z'
          filepath: testdata/randomization_bump_nicas_L10L2/member_%mem%
          state variables:
          - var3
          - var4
        pattern: '%mem%'
        nmembers: 25
        zero padding: 6
      localization:
        localization method: SABER
        saber central block:
          saber block name: BUMP_NICAS
          bump:
            general:
              datadir: testdata
              prefix: dirac_bump/_MPI_-_OMP_
              testing: true
            drivers:
              strategy: common
              load_nicas_local: true
            files:
              fname_nicas: error_covariance_training_bump_hdiag-nicas_2/_MPI_-_OMP__nicas
        input fields:
        - parameter: universe radius
          file:
            filepath: testdata/error_covariance_training_bump_hdiag-nicas_2/_MPI_-_OMP__loc_rh_2
    weight:
      value: 0.5
dirac:
  lon:
  - 0.0
  lat:
  - 0.0
  level:
  - 1
  variable:
  - var3
output dirac:
  filepath: testdata/dirac_bump/dirac_%id%
test:
  reference filename: testref/dirac_bump.ref
