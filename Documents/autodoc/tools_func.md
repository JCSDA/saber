# Module tools_func

| Type | Name | Purpose | Arguments          |
| :--: | :--: | :------ | :----------------- |
| function | [fletcher32](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L50) | Fletcher-32 checksum algorithm | <b>var</b> :  Variable - real(kind_real) - in |
| subroutine | [lonlatmod](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L70) | set latitude between -pi/2 and pi/2 and longitude between -pi and pi | <b>lon</b> :  Longitude (radians) - real(kind_real) - inout<br><b>lat</b> :  Latitude (radians) - real(kind_real) - inout |
| function | [lonlathash](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L101) | define a unique real from a lon/lat pair | <b>lon</b> :  Longitude (radians) - real(kind_real) - in<br><b>lat</b> :  Latitude (radians) - real(kind_real) - in<br><b>il</b> :  Level - integer - in |
| subroutine | [sphere_dist](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L133) | compute the great-circle distance between two points | <b>lon_i</b> :  Initial point longitude (radians) - real(kind_real) - in<br><b>lat_i</b> :  Initial point latitude (radians) - real(kind_real) - in<br><b>lon_f</b> :  Final point longitude (radians) - real(kind_real) - in<br><b>lat_f</b> :  Final point longilatitudetude (radians) - real(kind_real) - in<br><b>dist</b> :  Great-circle distance - real(kind_real) - out |
| subroutine | [reduce_arc](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L160) | reduce arc to a given distance | <b>lon_i</b> :  Initial point longitude (radians) - real(kind_real) - in<br><b>lat_i</b> :  Initial point latitude (radians) - real(kind_real) - in<br><b>lon_f</b> :  Final point longitude (radians) - real(kind_real) - inout<br><b>lat_f</b> :  Final point latitude (radians) - real(kind_real) - inout<br><b>maxdist</b> :  Maximum distance - real(kind_real) - in<br><b>dist</b> :  Effective distance - real(kind_real) - out |
| subroutine | [lonlat2xyz](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L197) | convert longitude/latitude to cartesian coordinates | <b>mpl</b> :  MPI data - type(mpl_type) - inout<br><b>lon</b> :  Longitude (radians) - real(kind_real) - in<br><b>lat</b> :  Latitude (radians) - real(kind_real) - in<br><b>x</b> :  X coordinate - real(kind_real) - out<br><b>y</b> :  Y coordinate - real(kind_real) - out<br><b>z</b> :  Z coordinate - real(kind_real) - out |
| subroutine | [xyz2lonlat](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L236) | convert longitude/latitude to cartesian coordinates | <b>mpl</b> :  MPI data - type(mpl_type) - in<br><b>x</b> :  X coordinate - real(kind_real) - in<br><b>y</b> :  Y coordinate - real(kind_real) - in<br><b>z</b> :  Z coordinate - real(kind_real) - in<br><b>lon</b> :  Longitude (radians) - real(kind_real) - out<br><b>lat</b> :  Latitude (radians) - real(kind_real) - out |
| subroutine | [vector_product](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L270) | compute normalized vector product | <b>v1</b> :  First vector - real(kind_real) - in<br><b>v2</b> :  Second vector - real(kind_real) - in<br><b>vp</b> :  Vector product - real(kind_real) - out |
| subroutine | [vector_triple_product](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L299) | compute vector triple product | <b>v1</b> :  First vector - real(kind_real) - in<br><b>v2</b> :  Second vector - real(kind_real) - in<br><b>v3</b> :  Third vector - real(kind_real) - in<br><b>p</b> :  Triple product - real(kind_real) - out<br><b>cflag</b> :  Confidence flag - logical - out |
| subroutine | [add](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L337) | check if value missing and add if not missing | <b>mpl</b> :  MPI data - type(mpl_type) - in<br><b>val</b> :  Value to add - real(kind_real) - in<br><b>cumul</b> :  Cumul - real(kind_real) - inout<br><b>num</b> :  Number of values - real(kind_real) - inout<br><b>wgt</b> :  Weight - real(kind_real) - in |
| subroutine | [divide](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L365) | check if value missing and divide if not missing | <b>mpl</b> :  MPI data - type(mpl_type) - in<br><b>val</b> :  Value to divide - real(kind_real) - inout<br><b>num</b> :  Divider - real(kind_real) - in |
| subroutine | [fit_diag](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L395) | compute diagnostic fit function | <b>mpl</b> :  MPI data - type(mpl_type) - inout<br><b>nc3</b> :  Number of classes - integer - in<br><b>nl0r</b> :  Effective number of levels - integer - in<br><b>nl0</b> :  Number of levels - integer - in<br><b>l0rl0_to_l0</b> :  Effective level to level - integer - in<br><b>disth</b> :  Horizontal distance - real(kind_real) - in<br><b>distv</b> :  Vertical distance - real(kind_real) - in<br><b>coef</b> :  Diagonal coefficient - real(kind_real) - in<br><b>rh</b> :  Horizontal support radius - real(kind_real) - in<br><b>rv</b> :  Vertical support radius - real(kind_real) - in<br><b>fit</b> :  Fit - real(kind_real) - out |
| function | [gc99](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L562) | Gaspari and Cohn (1999) function, with the support radius as a parameter | <b>distnorm</b> :  Normalized distance - real(kind_real) - in |
| function | [fit_func](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L586) | fit_function | <b>mpl</b> :  MPI data - type(mpl_type) - inout<br><b>distnorm</b> :  Normalized distance - real(kind_real) - in |
| subroutine | [fit_lct](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L625) | LCT fit | <b>mpl</b> :  MPI data - type(mpl_type) - inout<br><b>nc</b> :  Number of classes - integer - in<br><b>nl0</b> :  Number of levels - integer - in<br><b>dxsq</b> :  Zonal separation squared - real(kind_real) - in<br><b>dysq</b> :  Meridian separation squared - real(kind_real) - in<br><b>dxdy</b> :  Zonal x meridian separations product - real(kind_real) - in<br><b>dzsq</b> :  Vertical separation squared - real(kind_real) - in<br><b>dmask</b> :  Mask - logical - in<br><b>nscales</b> :  Number of LCT scales - integer - in<br><b>D</b> :  LCT components - real(kind_real) - in<br><b>coef</b> :  LCT coefficients - real(kind_real) - in<br><b>fit</b> :  Fit - real(kind_real) - out |
| subroutine | [lct_d2h](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L693) | from D (Daley tensor) to H (local correlation tensor) | <b>mpl</b> :  MPI data - type(mpl_type) - inout<br><b>D11</b> :  Daley tensor component 11 - real(kind_real) - in<br><b>D22</b> :  Daley tensor component 22 - real(kind_real) - in<br><b>D33</b> :  Daley tensor component 33 - real(kind_real) - in<br><b>D12</b> :  Daley tensor component 12 - real(kind_real) - in<br><b>H11</b> :  Local correlation tensor component 11 - real(kind_real) - out<br><b>H22</b> :  Local correlation tensor component 22 - real(kind_real) - out<br><b>H33</b> :  Local correlation tensor component 33 - real(kind_real) - out<br><b>H12</b> :  Local correlation tensor component 12 - real(kind_real) - out |
| subroutine | [lct_h2r](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L733) | from H (local correlation tensor) to support radii | <b>mpl</b> :  MPI data - type(mpl_type) - inout<br><b>H11</b> :  Local correlation tensor component 11 - real(kind_real) - in<br><b>H22</b> :  Local correlation tensor component 22 - real(kind_real) - in<br><b>H33</b> :  Local correlation tensor component 33 - real(kind_real) - in<br><b>H12</b> :  Local correlation tensor component 12 - real(kind_real) - in<br><b>rh</b> :  Horizontal support radius - real(kind_real) - out<br><b>rv</b> :  Vertical support radius - real(kind_real) - out |
| subroutine | [lct_r2d](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L779) | from support radius to Daley tensor diagonal element | <b>r</b> :  Support radius - real(kind_real) - in<br><b>D</b> :  Daley tensor diagonal element - real(kind_real) - out |
| subroutine | [check_cond](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L798) | check tensor conditioning | <b>d1</b> :  First diagonal coefficient - real(kind_real) - in<br><b>d2</b> :  Second diagonal coefficient - real(kind_real) - in<br><b>nod</b> :  Normalized off-diagonal coefficient - real(kind_real) - in<br><b>valid</b> :  Conditioning validity - logical - out |
| function | [matern](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L838) | compute the normalized diffusion function from eq. (55) of Mirouze and Weaver (2013), for the 3d case (d = 3) | <b>mpl</b> :  MPI data - type(mpl_type) - inout<br><b>M</b> :  Matern function order - integer - in<br><b>x</b> :  Argument - real(kind_real) - in |
| subroutine | [cholesky](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L884) | compute cholesky decomposition | <b>mpl</b> :  MPI data - type(mpl_type) - inout<br><b>n</b> :  Matrix rank - integer - in<br><b>a</b> :  Matrix - real(kind_real) - in<br><b>u</b> :  Matrix square-root - real(kind_real) - out<br><b>ierr</b> :  Error status - integer - out |
| subroutine | [syminv](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L937) | compute inverse of a symmetric matrix | <b>mpl</b> :  MPI data - type(mpl_type) - inout<br><b>n</b> :  Matrix rank - integer - in<br><b>a</b> :  Matrix - real(kind_real) - in<br><b>c</b> :  Matrix inverse - real(kind_real) - out<br><b>ierr</b> :  Error status - integer - out |
| subroutine | [histogram](https://github.com/JCSDA/saber/tree/develop/src/saber/bump/tools_func.F90#L992) | compute bins and histogram from a list of values | <b>mpl</b> :  MPI data - type(mpl_type) - inout<br><b>nlist</b> :  List size - integer - in<br><b>list</b> :  List - real(kind_real) - in<br><b>nbins</b> :  Number of bins - integer - in<br><b>histmin</b> :  Histogram minimum - real(kind_real) - in<br><b>histmax</b> :  Histogram maximum - real(kind_real) - in<br><b>bins</b> :  Bins - real(kind_real) - out<br><b>hist</b> :  Histogram - real(kind_real) - out |
